#pragma OPENCL EXTENSION cl_khr_fp64 : enable
#define TRUE 1
#define FALSE 0
#define EXPONENT_MASK 0x7fffffffffffffffULL
#define MANTISSA_MASK 0x000fffffffffffffULL

typedef unsigned long uint64_t;


bool isNormalOrZeroDouble(double x) {
    uint64_t bits = *(unsigned long long*)&x;
    uint64_t exponent = (bits & EXPONENT_MASK) >> 52;

    if (exponent == 0) {
        if (bits & MANTISSA_MASK) {
            // Denormal
            return FALSE;
        }

        // Zero
        return TRUE;
    }

    if (exponent == 0x7ff) {
        // Infinity or NaN
        return FALSE;
    }

    // normal
    return TRUE;
}

__kernel void filter